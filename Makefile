dev:
	pipenv install --dev

reqs:
	pipenv run pipenv_to_requirements -f

serve:
	pipenv run flask run

deploy: reqs
	gcloud app deploy app.yaml --project ${OTD_PROJECT_ID}

migrate-init:
	pipenv run flask db init

migrate-new:
	@echo "Enter migration message: "
	@read NAME; \
	pipenv run flask db migrate --message "${NAME}"

migrate-rev:
	@echo "Enter migration message: "
	@read NAME; \
	pipenv run flask db revision --message "${NAME}"

migrate:
	pipenv run flask db upgrade

migrate-history:
	pipenv run flask db history


test:
	FLASK_ENV=testing pipenv run pytest ./api/tests/test_*.py

lint:
	pipenv run flake8 --ignore=E501 --exclude=".svn,CVS,.bzr,.hg,.git,__pycache__,.tox,.eggs,*.egg,api/db/migrations/*.py,api/db/migrations/versions/*.py,api/db/models/__init__.py" api
