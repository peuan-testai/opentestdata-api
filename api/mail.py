from .config import get_config


class Email(object):

    def __init__(self, to_addr, subject, body):
        self.to_addr = to_addr
        self.subject = subject
        self.body = body

    def send(self):
        config = get_config()
        from_addr = f'Open Test Data <{config.EMAIL_FROM}>'
        if config.EMAIL_SENDING == 'cloud':
            pass  # TODO use sendgrid or mailjet, apparently

        # if we're not sending to cloud, just print locally so the dev can see
        # it if necessary
        print(f'''Sending fake e-mail:
-----------------------
To: {self.to_addr}
From: {from_addr}
Subject: {self.subject}
-----------------------
{self.body}
-----------------------''')

    @staticmethod
    def send_confirmation_email(to_addr, confirmation_url, token):
        subject = 'Confirm your e-mail address for opentestdata.org'
        link = f'{confirmation_url}?token={token}'
        body = f'''Hi there,

We're writing because you recently signed up using this e-mail address
at opentestdata.org. Please confirm your address by clicking the link
below!

{link}

Thanks,
The Open Test Data team

(Please do not reply to this e-mail as no one will read it.)
'''
        email = Email(to_addr, subject, body)
        email.send()
